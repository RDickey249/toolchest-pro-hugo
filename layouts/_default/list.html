{{ define "main" }}
<div class="page-header">
    <div class="container">
        <h1>{{ .Title }}</h1>
        {{ if .Description }}
        <p class="page-description">{{ .Description }}</p>
        {{ end }}
        
        {{ if .Parent }}
        <nav class="breadcrumb">
            <a href="/">Home</a> > 
            <a href="/categories/">Categories</a> > 
            {{ if .Parent.Parent }}
            <a href="{{ .Parent.Permalink }}">{{ .Parent.Title }}</a> > 
            {{ end }}
            <span>{{ .Title }}</span>
        </nav>
        {{ end }}
    </div>
</div>

<div class="container">
    {{ if .Pages }}
        {{ if eq .Type "categories" }}
            {{ $isMainCategory := not .Parent }}
            
            {{ if $isMainCategory }}
                <!-- Main category page - show subcategories -->
                {{ $subcategories := where .Pages "Type" "categories" }}
                {{ if $subcategories }}
                <div class="subcategories">
                    <h2>Subcategories</h2>
                    <div class="subcategory-grid">
                        {{ range $subcategories }}
                        <div class="subcategory-card">
                            <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
                            <p>{{ len .Pages }} tools</p>
                            {{ if .Description }}
                            <p class="subcategory-desc">{{ .Description | truncate 100 }}</p>
                            {{ end }}
                        </div>
                        {{ end }}
                    </div>
                </div>
                {{ end }}
            {{ else }}
                <!-- Subcategory page - show tools -->
                <div class="tools">
                    <h2>Tools in {{ .Title }}</h2>
                    <div class="tool-grid">
                        {{ range .Pages }}
                        <div class="tool-card">
                            <div class="tool-meta">
                                <span class="tool-category">{{ .Params.category | default .Parent.Title }}</span>
                            </div>
                            <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
                            <p class="tool-tagline">{{ .Params.tagline | default .Summary | truncate 100 }}</p>
                            <a href="{{ .Permalink }}" class="tool-link">Learn More â†’</a>
                        </div>
                        {{ end }}
                    </div>
                </div>
            {{ end }}
        {{ else }}
            <!-- Default list view -->
            <div class="page-list">
                {{ range .Pages }}
                <article class="list-item">
                    <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
                    {{ if .Summary }}
                    <p>{{ .Summary | truncate 150 }}</p>
                    {{ end }}
                    <div class="meta">
                        <time>{{ .Date.Format "January 2, 2006" }}</time>
                    </div>
                </article>
                {{ end }}
            </div>
        {{ end }}
    {{ else }}
        <div class="no-content">
            <h3>No content found</h3>
            <p>This section is currently empty.</p>
            <a href="/categories/" class="btn-secondary">Browse All Categories</a>
        </div>
    {{ end }}
</div>
{{ end }}